import requests
from dotenv import load_dotenv
import os

#Cargamos las variables en el entorno
load_dotenv()

# Leemos la clave API
GOOGLE_API_KEY = os.getenv("GOOGLE_API_KEY")

# Leemos id del motor de busqueda
SEARCH_ENGINE_ID = os.getenv("SEARCH_ENGINE_ID")

SEPARATOR_UP = "------------------- NUEVO RESULTADO -------------------"
SEPARATOR_DOWN = "·······················  FIN RESULTADO  ····························"
# Variables para complementar la URI
query = 'filetype:sql "MySQL dump" (pass|password|passwd|pwd)'
page = 1
lang = 'lang_es'

# URI de consulta
url = (f"https://www.googleapis.com/customsearch/v1?key= {GOOGLE_API_KEY}&cx={SEARCH_ENGINE_ID}&q={query}"
       f"&start={page}&lr={lang}")
data = requests.get(url).json()
results = data.get("items")

for result in results:
    print(SEPARATOR_UP)
    print(result.get("title"))
    print(result.get("link"))
    print(result.get('snippet'))
    print(SEPARATOR_DOWN)
    print()







